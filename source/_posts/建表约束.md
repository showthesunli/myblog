---
title: 建表约束
date: 2020-08-24 17:05:37
categories:
- 数据库
tags:
- 数据库
- mysql
---



## 主键约束

能够确定一张表中的唯一一条记录，该字段不重复且非空

```sql
create table user(
    id int primary key,
    name varchar(20)
);
```

## 联合主键

任何一个字段都不能为空

```sql
create table user2(
	id int,
	name varchar(20),
	primary key(id,name)
);
```

## 自增约束

插入记录时，自动增加

```sql
create table user3(
    id int primary key auto increment,
    name varchar(20)
);

insert into user3 (name) values(
    'zhangsan'
)
```

## 修改表结构，修改约束

```sql
create table user4(
    id int,
    name varchar(20)
)
--添加主键
alter table user4 add primary key(id);

--删除主键
alter talbe user4 drop primary key;

--使用modify修改字段，添加约束
alter table user4 modify int primary key;

```

## 唯一约束

修饰的字段值不能重复

```sql
create table user5(
    id int,
    name varchar(20)
);

--添加唯一约束
alter table user5 add unique(name);
--删除唯一约束
alter table user5 drop index name;


create table user6(
    id int,
    name varchar(20),
    unique(name)
);

create table user7(
    id int,
    name varchar(20) unique
)

```

***id和name组合起来不重复***

```sql
--命名唯一约束，以及在多列上添加唯一约束
alter table user5 add constraint uni_unser5 unique(id,name);

create table user8(
    id int,
    name varchar(20),
    unique(id,name)
);
```

## 总结

* 建表时添加约束
* alter...add...
* alter...drop...
* alter...modify...



## 非空约束

修饰的字段不能为空 NULL

``` sql
create table user9( 
	id int,
    name varchar(20) not null
);

insert into user9 (name) values(
    'zhangsan'
);

```

修改非空

```sql
alter table user9
modify id int not null;

alter table user9
drop id;


```

~~alter table user9 add not null(id);~~

## 默认约束

插入字段，没有指定值的时候，默认使用的值

```sql
create table user10(
    id int,
    name varchar(20),
    age int default 10
);

insert into user10(id,name) values(
    11,
    'zhangsan'
);

--删除字段默认属性
alter table user10 alter age drop default;

--设置字段默认属性
alter table user10
alter age set default 10;
```

## 外键约束

涉及两个表，父子

```sql
-- 班级
create table classes(
    id int primary key,
    name varchar(20)
);

-- 学生表
create table students(id int primary key,
                     name varchar(20),
                     class_id int,
                     foreign key(class_id) references classes(id));
                     
insert into classes values(1,'yiban');
insert into classes values(2,'erban');
insert into classes values(3,'sanban');
insert into classes values(4,'siban');

insert into students values(10001,'zhangsan',1);
insert into students values(10002,'zhangsan',2);
insert into students values(10003,'zhangsan',3);

--副表不能引用主表没有的字段值
--主表中有被副表引用的记录是不能被删除的

--增加外键约束
alter table students add foreign key (id) references classes(id)

--删除外键约束
alter table students drop foreign key students_ibfk_1;

--命名以及定义多个外键约束
create table students(
    id int,
    name varchar(20),
    class_id int,
    constraint fk_stuclasses foreign key(class_id) references classes(id)
);

```

# 数据库设计范式

## 第一范式 1NF

数据表中所有的字段都是不可分割原子值

## 第二范式 2NF

* 满足第一范式为前提
* 除主键外，每一列都必须完全依赖主键
* 复合主键下，每一列都必须完全依赖复合主键，不能只依赖复合主键的部分字段

主要应用于将表拆分

## 第三范式 3NF

