---
title: 服务器上的git
tags:
  - git
categories:
  - git
date: 2020-08-28 06:11:35
---


## 协议

想要跟远程服务器通信，就得先确定协议。在远程服务器上架设git的话，可选的协议有四种，分别是：本地协议、ssh、http|https、git

### 本地协议

基本上可以理解为本地文件系统上的一个目录，挂载了一个对成员有不同权限的文件系统。而git的认证与授权就依赖于这个文件系统对不同用户的授权。

基本上没有人会用这种方式架设远程的git服务，不做讨论。

### SSH协议

SSH有很多特性，基于这些特性，也使得git选用SSH协议时获得了很多优点。其特性如下：

* SSH的使用很普遍。即使没有，SSH也很容易架设。
* SSH是一个可以验证和授权的网络协议。
* 所有传输数据都要经过授权和加密。
* 传输的数据会被压缩。

SSH的缺点就是不能匿名访问，即每个用户都需要认证和授权。想象一下为每个用户配置SSH key是挺麻烦的，特别是用户很多的情况下。

这些缺点使SSH不能应用于两个使用场景，开源的项目和参与人数众多的项目。开源项目中，有可能任何人都有权clone一份代码供自己研究，但无权为项目贡献。参与人数众多的内部项目中，为每个人都进行认证和授权在管理会带来很大麻烦。

### HTTP/HTTPS

Git使用http协议通信会非常优美。其中最核心的理念就是，web服务器仅把Git的裸版本库当作当作普通文件对待，提供文件服务。而对于使用何种web服务器，以及web服务器用何种方式认证授权，都由用户自己选择。

在这基础之上，Git还可以通过一个CGI脚本，提供一个智能HTTP模式。这种模式可以仅通过一个URL判断出使用匿名访问服务器还是需要认证授权。

### git协议

git协议和SSH协议很像，但是它没有任何**授权机制**和**安全**措施。所以git协议比以上几个协议具有更快的传输速度。因为没有授权机制，所以大部分采用此协议的仓库的权限都是只读的，否则任何知道了此url的都可以向仓库进行推送。

## 小结

从以上几个协议的特点可以总结出一个Git服务通常应该采用的协议，即使用ssh或http或同时使用这俩协议，为某一些用户开放读写权限。而为其他用户开放git协议但只提供只读权限。

对于架设了防火墙的组织内部而言，提供git协议且开放写权限也是一种可行的方法。

